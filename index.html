<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fennec Knowledge Base</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,700|Montserrat:700">
  <style>
    body {
      background:#232426;
      color:#f4f7fa;
      font-family:'Inter',sans-serif;
      margin:0;padding:0;
    }
    header {
      background:#e4e7ea;
      color:#191b20;
      font-family:'Montserrat',sans-serif;
      font-weight:700;
      letter-spacing:0.05em;
      padding:0.6em 1.4em;
      display:flex;
      align-items:center;
      box-shadow:0 2px 10px #0003;
    }
    .container {
      display:flex;
      min-height:calc(100vh - 60px);
    }
    aside {
      width:220px;
      background:#191b20;
      padding:1em;
      box-shadow:2px 0 8px #0002;
    }
    select, button {
      width:100%;
      padding:0.4em;
      border-radius:0.4em;
      border:1px solid #59ecbe;
      background:#27292c;
      color:#fff;
      font-weight:600;
      margin-bottom:1em;
    }
    main {
      flex:1;
      padding:1.5em;
      overflow-y:auto;
    }
    .section {
      margin-bottom:2em;
      background:#2b2c30;
      border-radius:1em;
      padding:1em 1.4em;
      box-shadow:0 2px 6px #0004;
    }
    .section h2 {
      margin-top:0;
      color:#97efca;
      font-family:'Montserrat',sans-serif;
    }
  </style>
</head>
<body>
  <header>FENNEC KNOWLEDGE BASE</header>
  <div class="container">
    <aside>
      <label for="stateSelect" style="color:#97efca;font-weight:bold;">State</label>
      <select id="stateSelect"></select>
      <button id="showIssuesBtn">Global Issues</button>
    </aside>
    <main id="content"></main>
  </div>
  <script>
    const sections = [
      'Order Review',
      'Information Listed in the Articles',
      'Professional Service',
      'Most Common Rejections',
      'Special Notes',
      'Instructions'
    ];
    let kbData = {};
    let globalIssues = [];
    async function loadData(){
      kbData = await fetch('data/state_kb.json').then(r=>r.json());
      globalIssues = await fetch('data/global_issues.json').then(r=>r.json());
    }
    function populateStates(){
      const sel = document.getElementById('stateSelect');
      sel.innerHTML = Object.keys(kbData).map(s=>`<option value="${s}">${s}</option>`).join('');
    }
    function renderState(){
      const state = document.getElementById('stateSelect').value;
      const data = kbData[state] || {};
      const container = document.getElementById('content');
      container.innerHTML = '';
      sections.forEach(sec=>{
        const items = data[sec] || [];
        const div = document.createElement('div');
        div.className='section';
        div.innerHTML = `<h2>${sec}</h2><ul>` + items.map(t=>`<li>${t}</li>`).join('') + '</ul>';
        container.appendChild(div);
      });
    }
    function renderIssues(){
      const container = document.getElementById('content');
      container.innerHTML = '<div class="section"><h2>Global Issues</h2><ul>' + globalIssues.map(i=>`<li>${i}</li>`).join('') + '</ul></div>';
    }
    document.addEventListener('DOMContentLoaded', async ()=>{
      await loadData();
      populateStates();
      document.getElementById('stateSelect').onchange = renderState;
      document.getElementById('showIssuesBtn').onclick = renderIssues;
      renderState();
    });
  </script>
</body>
</html>
